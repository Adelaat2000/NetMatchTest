@{
    ViewBag.ApiUrl = "/api/accommodations";
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com"/>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

    <title>Stitch Design</title>
    <link href="data:image/x-icon;base64," rel="icon" type="image/x-icon"/>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <style type="text/tailwindcss">
        :root {
          --primary-color: #0d9488;
          --secondary-color: #f0fdfa;
          --text-primary: #1f2937;
          --text-secondary: #0d9488;
          --border-color: #ccfbf1;
          --background-muted: #f0fdfa;
        }
        body {
          font-family: 'Poppins', 'Noto Sans', sans-serif;
        }
    </style>
</head>

<body class="bg-gray-50 text-[var(--text-primary)]">
<div class="flex h-screen w-full bg-white">

    <aside class="flex w-80 flex-col border-r border-gray-200 bg-white">
        <div class="border-b border-gray-200 p-4">
            <div class="relative">
                <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"> search </span>
                <input class="w-full rounded-md border-gray-300 bg-gray-50 py-2 pl-10 pr-4 text-sm focus:border-[var(--primary-color)] focus:ring-[var(--primary-color)]"
                       placeholder="Search components..." type="text"/>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto">
            <nav class="space-y-4 p-4">

                <div>
                    <h3 class="mb-2 text-xs font-semibold uppercase text-gray-400 tracking-wider">Accommodations</h3>
                    <div class="space-y-1">
                        <a id="btn-hotel"
                           class="flex items-center gap-3 rounded-md bg-[var(--background-muted)] p-2 text-sm font-medium text-[var(--text-secondary)]"
                           href="#">
                            <span class="material-symbols-outlined"> hotel </span>
                            <span>Hotel</span>
                        </a>
                        <a id="btn-resort"
                           class="flex items-center gap-3 rounded-md p-2 text-sm font-medium text-gray-600 hover:bg-gray-100"
                           href="#">
                            <span class="material-symbols-outlined text-gray-500"> apartment </span>
                            <span>Resort</span>
                        </a>
                        <a id="btn-villa"
                           class="flex items-center gap-3 rounded-md p-2 text-sm font-medium text-gray-600 hover:bg-gray-100"
                           href="#">
                            <span class="material-symbols-outlined text-gray-500"> villa </span>
                            <span>Villa</span>
                        </a>
                    </div>
                </div>

                <div>
                    <button class="flex w-full items-center justify-between rounded-md p-2 text-sm font-medium text-gray-600 hover:bg-gray-100">
                        <span>Activities</span>
                        <span class="material-symbols-outlined text-gray-500"> local_activity </span>
                    </button>
                </div>

                <div>
                    <h3 class="mb-2 text-xs font-semibold uppercase text-gray-400 tracking-wider">Transportation</h3>
                    <div class="space-y-1">
                        <a class="flex items-center gap-3 rounded-md p-2 text-sm font-medium text-gray-600 hover:bg-gray-100" href="#">
                            <span class="material-symbols-outlined text-gray-500"> directions_car </span>
                            <span>Car Rental</span>
                        </a>
                        <a class="flex items-center gap-3 rounded-md p-2 text-sm font-medium text-gray-600 hover:bg-gray-100" href="#">
                            <span class="material-symbols-outlined text-gray-500"> train </span>
                            <span>Train Ticket</span>
                        </a>
                        <a class="flex items-center gap-3 rounded-md p-2 text-sm font-medium text-gray-600 hover:bg-gray-100" href="#">
                            <span class="material-symbols-outlined text-gray-500"> flight </span>
                            <span>Flight</span>
                        </a>
                    </div>
                </div>

            </nav>
        </div>
    </aside>


    <main class="flex flex-1 flex-col bg-gray-50">
        <div class="border-b border-gray-200 bg-white p-4">
            <h1 class="text-xl font-semibold text-gray-800">Select Hotel for Paris</h1>
            <p class="text-sm text-gray-500">Showing 245 hotels available</p>
        </div>

        <div class="flex items-center gap-4 border-b border-gray-200 bg-white px-4 py-3">
        </div>

        <div class="flex-1 overflow-y-auto p-6">
            <div id="accommodation-list" class="grid grid-cols-1 gap-6">
                <p class="text-gray-500">Laden...</p>
            </div>
        </div>
    </main>


    <aside class="flex w-96 flex-col border-l border-gray-200 bg-white">
    </aside>

</div>


@section Scripts {
<script>
    // Constants
    const TEXT = {
        loading: "Laden...",
        noResults: "Geen accommodaties gevonden.",
        error: (m) => `Fout bij het laden: ${m}`
    };

    const API_URL = "@ViewBag.ApiUrl";

    // DOM
    const listContainer = document.getElementById("accommodation-list");
    const btnHotel = document.getElementById("btn-hotel");
    const btnResort = document.getElementById("btn-resort");
    const btnVilla = document.getElementById("btn-villa");


    function renderAccommodations(accommodations) {
        listContainer.innerHTML = "";

        if (!accommodations || accommodations.length === 0) {
            listContainer.innerHTML = `<p class="text-gray-500">${TEXT.noResults}</p>`;
            return;
        }

        accommodations.forEach(acc => {
            const card = document.createElement("div");
            card.className = "flex gap-4 rounded-lg border border-gray-200 bg-white p-4 shadow-sm transition-shadow hover:shadow-md";

            const fromPrice = acc.fromPrice || 0;

            card.innerHTML = `
                <img alt="${acc.name}" class="h-40 w-40 rounded-md object-cover"
                     src="${acc.imageUrl || "https://via.placeholder.com/160"}"/>

                <div class="flex flex-1 flex-col">
                    <div>
                        <div class="flex items-start justify-between">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-800">${acc.name}</h3>
                                <p class="text-sm text-gray-500">${acc.location}</p>
                            </div>
                            <div class="flex items-center gap-1 text-sm font-medium text-yellow-500">
                                <span class="material-symbols-outlined text-base">star</span>
                                <span>${acc.rating}</span>
                                <span class="text-xs text-gray-400">(${acc.reviewCount})</span>
                            </div>
                        </div>

                        <div class="mt-2 flex items-center gap-2">
                            <span class="rounded-full bg-teal-50 px-2 py-1 text-xs font-medium text-teal-700">${acc.starRating}-star</span>
                            <span class="rounded-full bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700">${acc.type}</span>
                        </div>

                        <p class="mt-3 text-sm text-gray-600 line-clamp-2">${acc.description}</p>
                    </div>

                    <div class="mt-auto flex items-end justify-between pt-3">
                        <div>
                            <p class="text-sm text-gray-500">from</p>
                            <p class="text-xl font-bold text-gray-800">
                                â‚¬${Math.round(fromPrice)}
                                <span class="text-sm font-normal text-gray-500">/night</span>
                            </p>
                        </div>

                        <button class="rounded-md bg-[var(--primary-color)] px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-opacity-90">
                            Select Hotel
                        </button>
                    </div>
                </div>
            `;

            listContainer.appendChild(card);
        });
    }


    async function fetchAccommodations(type = null) {
        let url = API_URL;

        if (type) url = `${API_URL}/type/${type}`;

        listContainer.innerHTML = `<p class="text-gray-500">${TEXT.loading}</p>`;

        try {
            const response = await fetch(url);
            if (!response.ok) throw new Error(response.status);
            const data = await response.json();
            renderAccommodations(data);
        } catch (error) {
            listContainer.innerHTML = `<p class="text-red-500">${TEXT.error(error.message)}</p>`;
            console.error(error);
        }
    }


    btnHotel.addEventListener("click", e => {
        e.preventDefault();
        fetchAccommodations("Hotel");
    });

    btnResort.addEventListener("click", e => {
        e.preventDefault();
        fetchAccommodations("Resort");
    });

    btnVilla.addEventListener("click", e => {
        e.preventDefault();
        fetchAccommodations("Villa");
    });

    document.addEventListener("DOMContentLoaded", () => {
        fetchAccommodations();
    });
</script>
}
</body>
</html>
